import React, { useState,useEffect } from 'react';
import ClientForm from './components/ItemForm';
import ItemList from './components/ItemList';
import Listproduit from './components/List_produit';
import Produit from './components/Produit_image';
import Ajout_produits from './components/ajout_produits';
import { AuthProvider, useAuth } from './context/AuthContext';
import Login from './components/login';
import 'bootstrap/dist/css/bootstrap.min.css';
import 'bootstrap/dist/js/bootstrap.bundle.js';
import light from './images/light.svg';
import search from './images/search.svg';
import vin from './images/sans-bg/raisin.png';
import './index.css';
import { createProduit } from './services/api';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import Google from './components/google';
import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import ProtectedRoute from './components/ProtectedRoute';
import { 
  faStore, 
  faHome, 
  faBox, 
  faShoppingCart, 
  faUser, 
  faSignInAlt, 
  faSignOutAlt,
  faCog,
  faSearch,
  faInfoCircle,
  faEnvelope,
  faShoppingBag,
  faSun,
  faMoon,
  faWineGlass,
  
} from '@fortawesome/free-solid-svg-icons';

function App() {
  const [products, setProducts] = useState([]);
  const [editingProduct, setEditingProduct] = useState(null);
  const [showForm, setShowForm] = useState(false);
  useEffect(() => {
    
  }, []);
  
  
  const [refreshCount, setRefreshCount] = useState(0);
  const navItems = [
  { label: "Accueil", href: "#" },
  { label: "Produits", href: "#" },
  { label: "Contact", href: "#" },
  { label: "Traduction", href: "#" },
];

  const handleItemAdded = () => {
    setRefreshCount(prev => prev + 1);

  };
  const thème = ['dark','light'];
  const [clients, setClients] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const API_URL = 'http://localhost:5000/api/client';
  

  // Récupérer tous les clients
  const fetchClients = async () => {
    try {
      setLoading(true);
      const response = await fetch(API_URL);
      
      if (!response.ok) {
        throw new Error(`Erreur HTTP: ${response.status}`);
      }
      
      const data = await response.json();
      
      if (data.success) {
        setClients(data.clients);
      } else {
        throw new Error(data.error);
      }
    } catch (err) {
      setError(err.message);
      console.error('Erreur lors de la récupération des clients:', err);
    } finally {
      setLoading(false);
    }
  };
  useEffect(() => {
    fetchClients();
  }, []);
    const isAdmin = () => {
      return clients && clients.description === 'amis';
  };
  
  return (
    <div className="min-h-screen bg-dark-100 py-8">

     <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">
        <div class="container">
        
            <a class="navbar-brand" href="#">
            <FontAwesomeIcon icon={faWineGlass} />MonSite
            </a>
            
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            
            <div class="collapse navbar-collapse" id="navbarContent">
                
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">
                        <FontAwesomeIcon icon={faHome} />Accueil
                        </a>
                    </li>
                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="produitsDropdown" role="button" data-bs-toggle="dropdown">
                        <FontAwesomeIcon icon={faShoppingBag} />Produits
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Tous les produits</a></li>
                            <li><a class="dropdown-item" href="#">Nouveautés</a></li>
                            <li><a class="dropdown-item" href="#">Promotions</a></li>
                            <li><hr class="dropdown-divider" /></li>
                            <li><a class="dropdown-item" href="#">Par catégorie</a></li>
                        </ul>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                        <FontAwesomeIcon icon={faInfoCircle} />À propos
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                        <FontAwesomeIcon icon={faEnvelope} />Contact
                        </a>
                    </li>
                </ul>
                
                
                <form class="d-flex me-3">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Rechercher..." />
                        <button class="btn btn-outline-light" type="submit">
                        <FontAwesomeIcon icon={faSearch} />
                        </button>
                    </div>
                </form>
                
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link position-relative" href="#" id="panierDropdown" role="button" data-bs-toggle="dropdown">
                        <FontAwesomeIcon icon={faShoppingCart} />
                            <span class="badge bg-danger badge-notification">3</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><h6 class="dropdown-header">Votre panier</h6></li>
                            <li><a class="dropdown-item" href="#">Produit 1</a></li>
                            <li><a class="dropdown-item" href="#">Produit 2</a></li>
                            <li><hr class="dropdown-divider" /></li>
                            <li><a class="dropdown-item" href="#">Voir le panier</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link position-relative" href="#" id="panierDropdown" role="button" data-bs-toggle="dropdown">
                        <FontAwesomeIcon icon={faSun} />
                          
                        </a>
                    </li>
                    
                    <li class="nav-item dropdown" >
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="modal" data-bs-target="#loginModal">
                        <FontAwesomeIcon icon={faUser} />Se connecter
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#">
                            <FontAwesomeIcon icon={faUser} />Profil
                            </a></li>
                            <li><a class="dropdown-item" href="#">
                            <FontAwesomeIcon icon={faShoppingBag} />Commandes
                            </a></li>
                            
                            <isAdmin><li><a class="dropdown-item" href="#">
                            <FontAwesomeIcon icon={faCog} />Gestion de ventes et clients
                            </a></li></isAdmin>
                            
                            
                            
                            <li><hr class="dropdown-divider" /></li>
                            <li><a class="dropdown-item" href="#">
                            <FontAwesomeIcon icon={faUser} />
                                <i class="fas fa-sign-out-alt me-2"></i>Déconnexion
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
      <div class="container-fluid deepwine-container">
        <div class="row">
          <div class="col-lg-6 col-md-12 deepwine-left">
            <div class="wine-bottle-group">
              <img src={vin} alt="Bouteille de vin" class="img-fluid wine-bottle" />
              <img src="" alt="Verre de vin" class="img-fluid wine-glass" />
              <img src="" alt="Morceau de fromage" class="img-fluid cheese" />
            </div>
          </div>

          <div class="col-lg-6 col-md-12 deepwine-right">
            <div class="right-content">
              <h1 class="wine-title">Wine</h1>
              <p class="collection-text">COLLECTION</p>
              <h2 class="section-title-best">THE BEST GRADES</h2>
              <p class="section-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco.</p>
              
              <img src={vin} alt="Grappe de raisins" class="img-fluid grapes" />
              
              <h2 class="section-title-unique">UNIQUE TASTE</h2>
              <p class="section-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco.</p>
              
              <img src="splash.png" alt="Éclaboussure de vin" class="img-fluid wine-splash" />
              
              <div class="limited-edition">
                <p>LIMITED EDITION</p>
                <p>ONLY IN OUR SHOP</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div>
        <p></p>
      </div>

      <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-sign-in-alt me-2"></i>Connexion
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" required />
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Mot de passe</label>
                            <input type="password" class="form-control" id="loginPassword" required />
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="rememberMe"/>
                            <label class="form-check-label" for="rememberMe">Se souvenir de moi</label>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-gradient btn-lg">
                                <i class="fas fa-sign-in-alt me-2"></i>Se connecter
                            </button>
                        </div>
                    </form>
                    
                    <div class="text-center mt-3">
                        <a href="#" class="text-decoration-none">Mot de passe oublié ?</a>
                    </div>
                    
                    
                    
                    <div class="text-center">
                        <p class="mb-2">Ou connectez-vous avec</p>
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary">
                                <i class="fab fa-google me-2"></i>Google
                            </button>
                            <button class="btn btn-outline-dark">
                                <i class="fab fa-github me-2"></i>GitHub
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <span>Pas de compte ? <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#registerModal">S'inscrire</a></span>
                </div>
            </div>
        </div>
    </div>

    
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <FontAwesomeIcon icon={faUser} />Inscription
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName" class="form-label">Prénom</label>
                                <input type="text" class="form-control" id="firstName" required />
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName" class="form-label">Nom</label>
                                <input type="text" class="form-control" id="lastName" required />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="registerEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="registerEmail" required />
                        </div>
                        <div class="mb-3">
                            <label for="registerPassword" class="form-label">Mot de passe</label>
                            <input type="password" class="form-control" id="registerPassword" required />
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirmer le mot de passe</label>
                            <input type="password" class="form-control" id="confirmPassword" required />
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="acceptTerms" required />
                            <label class="form-check-label" for="acceptTerms">
                                J'accepte les <a href="#" class="text-decoration-none">conditions d'utilisation</a>
                            </label>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-gradient btn-lg">
                            <FontAwesomeIcon icon={faUser} />S'inscrire
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

      <div className="container mx-auto px-4 max-w-4xl">
        <main className="space-y-6">
          <Produit />
          <ItemList/>
        </main>

        <footer className="text-center mt-12 text-gray-500">
          <p>© 2023 Mon Projet Fullstack</p>
        </footer>
      </div>
    
    </div>
  );
}

export default App;